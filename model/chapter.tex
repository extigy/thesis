\begin{chapter}{\label{cha:theoretical_model}Theoretical Modelling of BEC}
\section{\label{section:meanfield} Mean-field description}
We aim to accurately model the dynamics of a closed system containing a dilute, weakly interacting Bose gas of $N$ atoms, at extremely low temperatures. One could model the entire system by constructing a N-body quantum wavefunction, which would follow the Schr\"odinger equation, but the complexity of this method makes it extremely unwieldy to model the large number of particles used in Bose-Einstein condensate (BEC) experiments happening all around the world.

We instead model the system with a mean-field theory, in which there are essentially two main approximations. Firstly, justified by the dilute property of the gas, any binary interaction between particles is assumed to be a contact delta function,
\begin{equation*}
V(\mathbf{r}-\mathbf{r}') = g \delta(\mathbf{r}-\mathbf{r}').
\end{equation*}
Interactions involving a higher number of particles are ignored. Secondly, we assume all particles in the condensate are macroscopically described by a single wavefunction, $\psi(\mathbf{r},t)$. As the particles all share the same phase and quantum state, $\psi(\mathbf{r},t)$ is a classical field. This second approximation also assumes that there are no particles contributing to thermal or quantum fluctuations beyond the classical field, and so is only strictly justified when the temperature, $T$, is exactly $0\mathrm{K}$.

\section{\label{section:gpe} The Gross-Pitaevskii Equation}
The result of this methodology is the Gross-Pitaevskii equation (GPE), 
\begin{equation}
\mathrm{i} \hbar \frac{\partial\Psi({\bf r},t)}{\partial t} = \left(-\frac{\hbar^2}{2m}\nabla^2 + V({\bf r},t) + g|\Psi({\bf r},t)|^2 - \mu \right) \Psi({\bf r},t),
\label{eq:gpe}
\end{equation}
where $V({\bf r},t) = V_{\mathrm{obj}}({\bf r},t) + V_{\mathrm{trap}}({\bf r},t)$. In the homogeneous case $V_{\mathrm{trap}}({\bf r},t)=0$, otherwise a harmonic trapping potential is used. In the case of a 3D spherically symmetric condensate the harmonic trapping potential is defined as $V_{\mathrm{trap}}({\bf r},t)=m\omega{\bf r}/2$

Taking into account the fact that the GPE is only valid at $T=0$, it turns out the equation is surprisingly successful at quantitatively modelling ultra-cold gasses, even up to a temperature of $T=\frac{T_c}{2}$, where $T_c$ is the critical temperature for Bose-Einstein condensation. The GPE is also successful at qualitatively modelling BEC based effects in higher temperature superfluids, such as liquid helium II.

A detailed explanation of the mean-field formulation of the model and the full derivation of the GPE is shown in Section \ref{appsection:gpeqft}.

\section{\label{section:quasi2dgpe} Quasi-Two-Dimensional Gross-Pitaevskii Equation}
	In some cases it is useful to rewrite the trapping potential so that the trapping frequencies are defined independently for several dimensions. An extreme example of this is the highly oblate, sometimes called `pancake', condensate, in which the trapping potential is defined as
	\begin{equation}
		V_{\mathrm{trap}}(x,y,z)=m\omega_\perp^2\frac{x^2+y^2}{2} + m\omega_z^2\frac{z^2}{2},
	\end{equation}
	with trapping frequencies $\omega_z >> \omega_\perp$ and under the condition $\hbar\omega_z >> \mu$, where $\mu$ is the 3D chemical potential. Tight $z$ confinement causes the dynamics to become essentially two dimensional (experimentally achieved in \cite{Gorlitz}) as the wavefuntion along $z$ becomes fixed into the independent harmonic oscillator ground state $\pi^{-1/4} l_z^{-1/2} \exp\left(-z^2/2l_z^2\right)$, where $l_z=\sqrt{\hbar/m \omega_z}$. A 2D GPE can then be used to model the system, with the modified interaction term $g_{2D} = g/( \sqrt{2\pi}l_z)$ \cite{parkerthesis}.  The 3D chemical potential $\mu$ is also modified (further details on the chemical potential can be found in Section \ref{section:mu}) and all other three-dimensional properties become two-dimensional.


\section{\label{section:gpedimless} Dimensionless Gross-Pitaevskii Equations}
	Bose-Einstein condensates can be formed with almost any size or scale. An ultra-cold BECs topology or atom interaction strength can be fairly easily changed with magnetic/optical potentials and Feshbach resonances. Superfluid helium can have vortex core sizes of $\sim$1 or $\sim$100 angstroms, depending on the isotope of helium used. The cores of neutron stars are even theorised to be superfluid. For this reason, it is desirable to rescale the length scales used in the GPE so that any of the calculations performed can be easily reformulated into any length scale desired. We make this process easier by doing all calculations with dimensionless parameters. 
	\subsection{\label{section:gpedimlesshomg} Homogeneous GPE}

		When discussing a homogeneous system with repulsive iterations and no external or trapping potentials, $\Psi$ does not depend on $\mathrm{r}$ or $t$. We can easily find the homogeneous background density of the system: $g|\Psi|^2\Psi - \mu\Psi = 0 \Rightarrow |\Psi|^2 = \mu/g = \rho$. Let us begin by rescaling the wavefunction using this value, $\psi = \Psi/\sqrt{\rho}$.

		By dimensional arguments, the natural units of space and time are $\xi = \hbar/\sqrt{mg\rho}$ and $\tau = \hbar/(g\rho)$. We now define dimensionless values $\tilde{t} = t/\tau$, $\tilde{\mathrm{r}} = \mathrm{r}/\xi$ and $\tilde{V} = V/\mu$, leading to the dimensionless homogeneous GPE,

		\begin{equation}\label{eq:dimgpehomg}
		\mathrm{i}\frac{\partial\psi({\bf \tilde{r}},\tilde{t})}{\partial {\tilde{t}}} = \left( -\frac{1}{2}\tilde{\nabla}^2 + |\psi({\bf \tilde{r}},\tilde{t})|^2 + \tilde{V}_{\mathrm{obj}}({\bf \tilde{r}},\tilde{t}) - 1 \right) \psi({\bf \tilde{r}},\tilde{t}).
		\end{equation}
		A full derivation can be found in Appendix [SOMETHING]. In the interests of neatness the dimensionless signifier $\tilde{~}$ will be omitted in future discussions of the homogeneous GPE. Instead, quantities used with the wavefunction symbol $\psi$ are to be regarded as made dimensionless in this way.


	\subsection{\label{section:gpedimlesstrap} Trapped GPE}
		When discussing the a trapped condensate we drop the dimensionless modifiers for each quantity and use the equation,
		\begin{equation}\label{eq:dimgpetrapped}
		\mathrm{i}\frac{\partial\phi({\bf r},t)}{\partial t} = \left( -\frac{1}{2}\nabla^2 + g|\phi({\bf r},t)|^2 + V({\bf r},t) - 1 \right) \phi({\bf r},t).
		\end{equation}
	In the interests of neatness the dimensionless signifier $\hat{~}$ will be omitted in future discussions of the homogeneous GPE. Instead, quantities used with the wavefunction symbol $\phi$ are to be regarded as made dimensionless in this way.

\section{\label{section:dgpe} The Dissipative Gross-Pitaevskii Equation}
	\subsection{\label{section:gamma} Phenomenological dissipation}
	The GPE can be modified to provide a simple phenomenological model of a condensate's interaction with the thermal cloud. The phenomenological damping term, $\gamma$, is added to the right hand side of the GPE with the effect that the energy in the system no longer remains constant. The energy will instead vary over time to approach some constant value. This has the effect of damping out any excitations made to the condensate, and over time the wavefunction approaches the steady state. A microscopic justification for this model was provided by Penckwitt et al [CITE] and Gardiner at al [CITE]; by studying the growth of a condensate in the presence of a rotating thermal cloud an expression for $\gamma$ was found.
		\begin{equation}\label{eq:dissgamma}
		\gamma = \frac{4m\tilde{g}a^2kT}{\pi\hbar^2} \approx 0.01,
		\end{equation}
	where $k$ is Boltzmann's constant and $\tilde{g} = 3$ is a factor used for correction. As $\gamma$ is proportional to temperature, in this thesis various values of $\gamma$ will be used as a qualitative probe of finite-temperature dynamics with only marginally more complex numerical methods. This leaves us with
		\begin{equation}\label{eq:dissgpe}
		(\mathrm{i}-\gamma) \hbar \frac{\partial\Psi({\bf r},t)}{\partial t} = \left(-\frac{\hbar^2}{2m}\nabla^2 + V({\bf r},t) + g|\Psi({\bf r},t)|^2 - \mu \right) \Psi({\bf r},t),
		\end{equation}

\section{\label{section:movframe} Transforming the reference frame}
	\subsection{\label{section:linearmovframe} Directional moving frame}
	The GPE is transformed into the reference frame moving along $x$ via the addition of the Galilean term $ i\hbar v\frac{\partial}{\partial x} \Psi$ to the right-hand side of the GPE (\ref{eq:gpe1}), where $v$ is the frame velocity. 
	\subsection{\label{section:rotatingframe} Rotating frame}
	Recall in classical mechanics that the angular momentum is defined as a vector product of the position $\mathbf{r}$ and the momentum $\mathbf{p}$,
	\begin{equation*}
		\mathbf{L} = \mathbf{r} \times \mathbf{p} = 
		\left| \begin{array}{ccc}
\underline{i} & \underline{j} & \underline{k} \\
x & y & z \\
p_x & p_y & p_z \end{array} \right|.
	\end{equation*}
	In quantum mechanics the corresponding position and momentum {\it operators} are defined as $\hat{R} = \mathbf{r}$ and $\hat{P} = -i\hbar\nabla$, and so we can define a similar angular momentum {\it operator},
	\begin{equation}\label{eq:angmomentumop}
		\hat{L} = \hat{R} \times \hat{P}.
	\end{equation}
	The components of equation \ref{eq:angmomentumop} can also be written as differential operators,
	\begin{equation}
		\hat{L}_x = -i\hbar\left ( y \frac{\partial}{\partial z} - z \frac{\partial}{\partial y} \right ),~~~
		\hat{L}_y = -i\hbar\left ( z \frac{\partial}{\partial x} - x \frac{\partial}{\partial z} \right ),~~~
		\hat{L}_z = -i\hbar\left ( x \frac{\partial}{\partial y} - y \frac{\partial}{\partial x} \right ),~~~
	\end{equation}
 which can then be added to the right hand side of the GPE to modify it such that it is in the rotating reference frame. For example, the GPE in the frame rotating about the $z$ axis with angular momentum $\Omega$ is written,
	\begin{equation}\label{eq:rotframegpe}
	\mathrm{i}\hbar \frac{\partial\Psi({\bf r},t)}{\partial t} = \left(-\frac{\hbar^2}{2m}\nabla^2 + V({\bf r},t) + g|\Psi({\bf r},t)|^2 - \mu -i\hbar\Omega\left [ x \frac{\partial}{\partial y} - y \frac{\partial}{\partial x} \right ] \right ) \Psi({\bf r},t),
	\end{equation}

\section{\label{section:mu} The role of the chemical potential}
\section{\label{section:hydrodynamic} Hydrodynamic interpretation}
	Often it can be helpful to write the GPE, via the so called Madelung transformation, as a set of hydrodynamic equations. The transformation reinterprets the wavefunction $\Psi$ as a magnitude directly related to the fluid density and a phase which is directly related to the fluid velocity. We write the wavefunction in the form
	\begin{equation}
		\Psi({\bf r},t) = R({\bf r},t)\exp (\mathrm{i}\theta({\bf r},t)),
	\end{equation}
	 and identify the fluid density as $\rho=mR^2$ and the velocity as $\mathbf{v} = \frac{\hbar}{m}\nabla\theta$.
	In vector form we obtain a continuity equation
	\begin{equation}
	  \frac{\partial \rho}{\partial t} + \nabla(\rho{\bf v}) = 0,
	  \label{eq:MTcont}
	\end{equation}
	and an equation similar to the Euler equation for an inviscid fluid,
	\begin{equation}
	\rho\left( \frac{\partial \mathbf{v}}{\partial t} + \left( \mathbf{v} \cdot \nabla \right)\mathbf{v} \right) = -\nabla p - \nabla \mathbf{P} - \rho \nabla \left(\frac{V}{m}\right).
	\end{equation}
	where $P_{jk} = -\frac{\hbar^2}{4m^2}\rho\frac{\partial^2\ln{\rho}}{\partial x_j \partial x_k}$.
	A detailed derivation of this result can be found in Appendix \ref{appsection:madtrans}.

\section{\label{section:solutions} A selection of analytical solutions}
	\subsection{\label{section:wall} Density near a wall}
	\subsection{\label{section:soliton} Soliton solutions}
		\begin{equation}
		\Psi(x) = \Psi_0 \tanh \left( \frac{x}{\sqrt{2}\xi} \right)
		\label{eq:soliton}
		\end{equation}
	\subsection{\label{section:vortices} A note on vortex solutions}
\section{\label{section:inital} Initial Conditions}
	\subsection{\label{section:tftrap} Thomas Fermi profile of a trapped condensate}
	Fixed in time $\Psi$ and $V$.
	\begin{equation}
	\sqrt{\frac{\mu - V({\bf r})}{g}} =  \Psi({\bf r})
	\label{eq:TF}
	\end{equation}
	\subsection{\label{section:cfield} Classical Field approximation with a homogeneous condensate}
		\begin{equation}
		\psi({\bf r},t) = \sum_{\bf k} a_{\bf k} \exp (\mathrm{i}{\bf k}\cdot{\bf r}),
		\label{eq:cFieldIC}
		\end{equation}
		where the complex Fourier amplitudes $a_{\bf k}$ are related to the occupation numbers $n_{\bf k}$ through $\braket{a_{\bf k}^{\,}a_{\bf k'}^*} = n_{\bf k}\delta_{\bf kk'}$. The phase of the complex amplitudes $a_{\bf k}$ are distributed uniformly on $[0,2\pi]$ while $|a_{\bf k}|$ is distributed randomly with fixed mean equal to unity; it has been found that different distributions of $|a_{\bf k}|$ make no qualitative difference to the turbulent evolution[phys rev A 66 013603]. [TODO: write about choice of E and N here to get different condensate fractions]

		We also have the integral distribution function,
		\begin{equation}
		D_k = \sum_{k'<k}n_{\bf k}.
		\label{eq:intDistFunc}
		\end{equation}
		This is a coarse-grained characteristic of the particle distribution which shows how many particles have momenta less than $k$.

\section{\label{section:potentials}Creating obstacles with repulsive potentials}

\subsection{\label{section:3dobjpotential} Three-dimensional elliptical Gaussian}
In our 3D simulations, we solve the 3D GPE of Equation (1), where the localized 3D obstacle is modelled via a repulsive ellipsoidal Gaussian potential,
\begin{equation}
V({\bf r}, t)=V_0 \exp \left( -\frac{\varepsilon^2(x-x_0-vt)^2}{d^2} -\frac{(y-y_0)^2}{d^2}-\frac{(z-z_0)^2}{d^2}\right),
\label{eq:potential3D}
\end{equation}
where  $V_0$ is its (constant) amplitude, $d$ its width in the $y$ and $z$ directions, and $(x_0,y_0,z_0)$ its initial coordinates.  

\subsection{\label{section:3dcylinderpotential} Three-dimensional cylindrical Gaussian}
\subsection{\label{section:3dafmpotential} Three-dimensional `realistic' rough-surface}
\subsection{\label{section:2dobjpotential} Two-dimensional Gaussian}

In 2D, we model the obstacle via a moving repulsive Gaussian potential of the form,
\begin{equation}
V({\bf r}, t)=V_0 \exp \left( -\frac{\varepsilon^2(x-x_0-vt)^2}{d^2} -\frac{(y-y_0)^2}{d^2}\right).
\label{eq:potential2D}
\end{equation}




\subsection{\label{section:2dbitmappotential} Two-dimensional arbitrary bitmap}
\end{chapter}
